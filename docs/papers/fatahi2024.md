# EXOTIC

The EXOplanet Transit Interpretation Code, is a Python package that streamlines the transformation of photometric data from any telescope into lightcurves for transiting exoplanets. EXOTIC also features a built-in orbit fitting module which takes into account transit and radial velocity measurements within a Bayesian framework yielding full posterior distributions through nested sampling. Additionally, the pipeline supports machine readable outputs that can be easily contributed to Exoplanet Watch, a citizen science project which helps improve the efficiency of scheduling future observations by performing ephemeris maintenance. This paper demonstrates the functionality of EXOTIC by delivering an in-depth explanation of its algorithmic procedures and explanations of the plots it generates using datasets of WASP-1~b, a target selected for its abundance of available data and its historical significance in offering insights into exoplanetary systems' formation, evolution, and diversity. The EXOTIC package is open source https://github.com/rzellem/EXOTIC and designed to interface with various telescopes ensuring adaptable and reliable performance regardless of hardware.

## Introduction

One of the James Webb Space Telescope's (JWST) missions is to examine the atmospheric features of transiting exoplanets. JWST relies on up-to-date exoplanet transit ephemerides to ensure efficient observatory use, allowing for in-depth exploration of atmospheres and other planetary traits. Exoplanets such as WASP-1~b exhibit characteristics, including Jupiter-sized planets with close orbits, that challenge planetary formation models. Nearly three decades since the first detection of a hot Jupiter, there has yet to be unanimity of how they originated. Various hypotheses, such as disk migration, in situ formation, and high-eccentricity migration, have been proposed to explain their existence (see for a review). Adding to the unknown, measurements of WASP-1~b's radius deviate from previously published models of hot Jupiters, suggesting that even without a core, its size cannot be adequately explained. Thus, it joins the increasing number of hot Jupiters with unexpected dimensions. Further investigations into WASP-1~b and hot Jupiters are necessary to draw more definitive conclusions about planetary formation.

Several techniques exist for discovering an exoplanet, with the transit method leading to many such discoveries. A periodic decrease in the light emitted from a star, typically ~1\%, often indicates an exoplanet transiting in front of it. These transits are detected through photometry, providing valuable information about the exoplanet. The transit method aids in determining the exoplanet's size by measuring transit depth and determining the ratio between the planet and its host star's radius $R_{p}/R_{s}$. This method also enables the spectroscopic characterization of exoplanet atmospheres, including the identification of substances such as water vapor and carbon dioxide. NASA's Transiting Exoplanet Survey Satellite (TESS), an all-sky survey mission, relies on the transit method to aid in its discovery of potential transiting exoplanets. Currently, the NASA Exoplanet Archive lists more than 5500 confirmed exoplanets, with over 4100 exoplanets discovered using the transit method and more than 4600 candidates from the TESS project awaiting confirmation that require follow-up observations.

The significant increase in discovered exoplanets and candidates calls for follow-up observations to identify planetary characteristics. Large observatories such as the JWST are using these discovered targets as potential exoplanet studies. However, ephemerides may become ``stale'' for transiting exoplanets, which is when the mid-transit time $\Delta T_{mid}$ $1\sigma$ uncertainty exceeds half the transit duration $t_{dur}$. Follow-up observations are needed to reduce the overhead of large observatories by minimizing the uncertainty in the next predicted mid-transit time. By conducting transit maintenance with a 6" telescope, it is possible to achieve $3\sigma$ observations for the transit of $\ge$188 exoplanets, potentially saving approximately 10,000 days of observation time for both JWST and ARIEL.

Citizen science projects such as Exoplanet Watch\footnote https://exoplanets.nasa.gov/exoplanet-watch/ and ExoClock\footnote https://www.exoclock.space host a network of small ground-based telescopes ($\le$1 m) that aims to increase the efficiency of large observatories by keeping ephemerides fresh for transiting exoplanets and candidates. To support the project's objective, Exoplanet Watch developed an open-sourced data reduction tool written in Python 3 called the EXOplanet Transit Interpretation Code. EXOTIC is a universal data reduction tool that uses raw FITS files or a pre-reduced time series to fit a model lightcurve with full posteriors. Designing a universal data reduction tool for transiting exoplanet science requires compatibility with various telescopes and a robust optimization algorithm incorporating uncertainty quantification. To showcase how EXOTIC operates, we utilize data of WASP-1~b to process raw FITS files through the pipeline. Following the analysis, EXOTIC provides results in a report form that users can submit to the American Association of Variable Star Observers https://www.aavso.org (AAVSO). Furthermore, users can conduct further analysis using supplementary software packages in the EXOTIC repository.

## Implementation
Once provided with a sequence of images including an exoplanet's transit, EXOTIC conducts photometry and updates key orbital parameters, including the mid-transit time $T_{mid}$, planet-star radius ratio $R_{p}/R_{s}$, and orbital inclination $i$. Users can also supply prereduced data in place of an image sequence. The pipeline then generates a model lightcurve of the exoplanet transit along with files including refined system parameters.

## User Interacting & Data Entry
EXOTIC provides multiple user interfaces, enabling users to process their transit data efficiently. These interfaces allow users to systematically input observational data along with planetary and stellar parameters, streamlining the analysis and reduction of transit observations.

## Interface Overview
Users can reduce their dataset through multiple interfaces, including prompted inputs from the command line, Graphical User Interface (GUI), initialization file, or Google Colaboratory Notebooks\footnote{\url{https://exoplanets.nasa.gov/exoplanet-watch/exotic/welcome/}}. EXOTIC creates an initialization file at the beginning of the process, which contains observational information, paths to essential directories such as those for science images, calibration images, and a folder for saving results, along with stellar and planetary parameters. Users can share or use the initialization file again for future reductions. We highly recommend the Colaboratory Notebook for beginners or users who prefer guided step-by-step assistance in their data reduction. This notebook includes features like entering target and comparison star coordinates by matching them to a star chart. For those with large datasets and slow internet speeds or data capping, we recommend downloading EXOTIC locally and reducing the dataset by using the GUI or creating an initialization file.


## Handling User Inputs
The EXOTIC interfaces are designed to make it easy for users to collect observational information and parameters related to planets and their host stars. Initially, the interface prompts users to confirm the presence of specified image directories and an output directory. During this process, the pipeline also checks that these directories exist and verifies that the images are in supported formats, including .FITS, .FIT, .FTS, .FZ, .FITS.GZ, and .FIT.GZ. If users need to add their own file extension, they must be compatible with the Flexible Image Transport System (FITS) standards.

EXOTIC then scrapes the FITS file headers to check if latitude, longitude, and elevation parameters are present. For latitude and longitude, the system checks that they conform to acceptable geographic limits: latitude must range from  $-90^\circ$ to $+90^\circ$, with positive signs indicating northern latitudes and negative signs for southern ones, while longitude should be between $-180^\circ$ to $+180^\circ$, with positive indicating east and negative for west. If the signs are incorrect or the parameters are missing from the headers, EXOTIC prompts the user for corrections. If elevation does not exist in the file header, EXOTIC attempts to obtain it using the verified latitude and longitude through Open Elevation\footnote{\url{https://open-elevation.com}}. Should this query fail, the user must manually input the elevation. These validation steps ensure that the observational data is properly geotagged, enhancing the reliability of the astronomical analysis. The validated latitude, longitude, and elevation allow EXOTIC to convert the local observation time into Barycentric Julian Date in Barycentric Dynamical Time (BJD\_TDB) using {barycorrpy}, which is essential for precise time-series analysis.

EXOTIC actively ensures accurate data processing by requiring users to provide detailed information about the observational instruments. To begin, users must enter the filter used during observations, adhering to the AAVSO International Database https://www.aavso.org/filters standards. If an accepted AAVSO filter is used, EXOTIC automatically extracts the Full Width Half Maximum (FWHM) from the database. Otherwise, if a custom filter is selected, the user must input the filter's wavelength range by entering two separate float/decimal numbers representing the start and end wavelengths. For example, if a CV filter is used, which corresponds to a luminance filter in AAVSO, and the camera has a quantum efficiency range of 400.0 nm to 800.0 nm, the user would enter these values. Apart from filter details, users must input details such as the observation date, pixel binning, observing notes, and camera type (CCD or DSLR) for the AAVSO output file. Optionally, users may also include primary AAVSO observer codes for lead observers and secondary observer codes for participants serving as co-observers or co-analyzers to receive credit for their contributions. Optional details include a demosaicing format for grayscale conversion or single color channel extraction, science image exposure time per AAVSO guidelines, an image scale to create FOV plots, and a custom filter's FWHM if it is not in AAVSO. By supplying all this information, users allow EXOTIC to analyze datasets and output the required AAVSO formats efficiently.

The pipeline also requires the user to input the coordinates for the target and comparison stars. It then checks these coordinates to ensure they are numerical and within the image bounds. If the coordinates are incorrect or missing, the EXOTIC prompts for re-entry. If the images are plate-solved or the user requests plate-solving using {Astrometry.net}\footnote{\url{https://nova.astrometry.net}}, the pipeline cross-references the entered target coordinates against those calculated, ensuring accuracy within a $100^{\prime\prime}$ margin of error. When an image is plate-solved, EXOTIC consults the AAVSO's Variable Star Index\footnote{\url{https://www.aavso.org/vsx/}} (VSX) and Variable Star Plotter\footnote{\url{https://app.aavso.org/vsp/}} (VSP) to identify and acquire suitable comparison stars, excluding variable stars to prevent inaccuracies in planetary parameters due to stellar variability.

Upon user request and once an image is plate-solved, EXOTIC leverages AAVSO's VSX and VSP API to identify variable comparison stars and to acquire comparison stars, respectively. EXOTIC excludes variable comparison stars to prevent inaccuracies in planetary parameters like the planet-star radius ratio ($R_{p}/R_{s}$) due to brightness fluctuations from starspots and faculae affecting transit depth and flux measurements. The VSP adds comparison stars with known visual magnitudes to estimate stellar and planetary parameter measurements and produces a star chart that helps users identify their target and comparison stars.

Lastly, EXOTIC automatically extracts planetary and stellar parameters from the NASA Exoplanet Archive (NEA) using the exoplanet's name. If parameters are missing, EXOTIC uses established scientific principles and laws to estimate these values (e.g., Newton's version of Kepler's Third Law to estimate the semi-major axis, $a$) or prompt users to input them. This comprehensive approach ensures that all necessary data is collected and validated.

Each parameter in Table~\ref{tab:initial_params} significantly influences the shape of the lightcurve. For example:
\begin{itemize}
    \item Orbital Period ($P$): Determines the time interval between successive transits, directly affecting the frequency of dips in the lightcurve.
    \item Mid-Transit Time ($T_{mid}$): Defines the central time of the transit, essential for timing the transit event.
    \item Planet-Star Radius Ratio ($R_p/R_s$): A larger ratio results in a deeper transit, causing a more prominent dip in the lightcurve.
    \item Scaled Semi-major Axis ($a/R_s$): Affects the transit duration, as a larger scaled semi-major axis generally leads to a shorter transit duration.
    \item Orbital Inclination ($i$): Determines the angle of the planet's orbit relative to our line of sight. A higher inclination means the planet crosses closer to the star's center, resulting in a longer transit duration and a larger dip in brightness.
    \item Eccentricity ($e$) and Periastron ($\omega$): Both parameters describe the shape and orientation of the orbit. Eccentricity and the argument of periastron affect transit duration and can create asymmetrical light curves by varying the planet's speed and distance from the star during different orbital phases, impacting the ingress and egress.
    \item Stellar Temperature ($T_{eff}$), Metallicity, and Surface Gravity (log $g$): These stellar parameters influence the star's brightness variation due to limb darkening during the transit event, affecting the shape of the lightcurve during the ingress and egress phases.
\end{itemize}
By determining these parameters, EXOTIC can generate a model lightcurve, enabling better understanding and characterization of the exoplanet.


## Image Calibration
EXOTIC offers several options for calibrating science images, and while not mandatory, users can submit calibration frames such as darks, biases, and flats, which EXOTIC utilizes to correct the science images. Also, as not all cameras take grayscale images, EXOTIC can convert color images to grayscale by combining color channels or extracting a single color channel. When supplied with a Bayer Color Filter Array (CFA) and its pattern, the {colour demosaicing} package produces a demosaiced image that the pipeline can then process. The standard EXOTIC notebook allows users to visually inspect each image and eliminate apparent outliers, such as those caused by bad weather. By filtering out images with artifacts, distortions, or other anomalies, such as a passing cloud, users can enhance the quality of the lightcurve and minimize the impact of potential errors or inconsistencies in the data.

## Coordinate Tracker
Stellar objects may shift in images during observations due to equipment-guiding capabilities. EXOTIC estimates the shift in coordinates between images instead of stacking and aligning them, which can lead to interpolation errors and flux conservation issues. To locate each star's geometric center in the image and ensure precise flux measurements despite changes in object positions, EXOTIC employs centroids and various tracking techniques to monitor both the target and comparison stars, as described in detail in the following subsections. Initially, EXOTIC uses flux-weighted centers to determine object centroids, as this method is more robust in crowded field photometry. After establishing the centroids, EXOTIC initiates tracking by prioritizing speed through various methods. The pipeline first uses the existing plate solution of the image, then tries to identify asterisms, and finally applies a Discrete Fourier Transform (DFT) as an alternative if these approaches prove ineffective.

## Plate Solution
Initially, EXOTIC tracks objects by utilizing the world coordinate system (WCS) provided in the FITS header when accessible. The procedure starts with EXOTIC converting the target and comparison stars from their right ascension and declination into pixel coordinates within the image using the {astropy} package. Then, the pipeline checks that it has identified the correct stars through two methods: first, by comparing the brightness of each star with its brightness in the previous image, and second, by ensuring the pixel distances between the target and comparison stars remain close to constant across images. Should a star's brightness exhibit a relative change greater than 50\% or the pixel distances between the target and comparison stars deviate by more than one pixel, the pipeline adopts a different tracking approach involving asterisms.

## Similar Asterisms
The following tracking approach employs the {astroalign} package to identify analogous triangles in two images and calculate the affine transformation between them to locate the specified stars. Using {astroalign}, EXOTIC scans the first image to ensure it identifies all corresponding stars, ensuring the presence of both target and comparison stars in every image. Figure depicts the tracking performance by displaying the centroid positions of the source plotted based on pixel positions from the provided dataset. Challenges can arise in finding comparable triangles between two images, particularly in crowded fields or when there are too few sources. When no similarities exist between the images, EXOTIC filters out potential hot pixels based on percentiles of pixel values only at this later stage, deliberately delaying this process to minimize increases in processing time, and then attempts to re-estimate the transformation matrix. If this procedure fails, the software reverts to the final tracking method using phase correlation, commonly employed in image processing applications.


## Phase Correlation
The final tracking method utilized by the pipeline is the DFT method, which determines the similarity transformation between images featuring crowded fields or limited sources. Leveraging the {imreg\_dft} package, which utilizes the Fast Fourier Transform (FFT) algorithm, EXOTIC estimates discrepancies in scale, rotation, and position between the images. Similar to the previously mentioned similar asterisms approach with {astroalign}, a hot pixel filter is applied if the DFT fails to identify a transformation. If applying the DFT proves ineffective in establishing similarity, the pipeline discards the current FITS file from reduction and proceeds to the following file until it finds an algorithm that can apply an alignment.


## Photometric Routine
EXOTIC employs two photometric methods to determine stellar flux, which is the amount of a star's energy emitted per unit area per unit time: point-spread function (PSF) and aperture photometry. The following subsections detail these methods and explain how the pipeline selects the most suitable one for analysis.

## Point-Spread Function Photometry
The PSF models the light distribution from a single point source, considering optical and atmospheric effects that cause light to disperse. PSF extraction, particularly effective in crowded stellar fields, distinguishes between overlapping objects by fitting the PSF to each star's observed light profile. EXOTIC employs this technique by applying a 2D Gaussian function to a sub-field containing the target using least-squares minimization. Once the 2D Gaussian function is fit to the data, the code performs a 2D Gaussian integral to calculate the total flux. This integral considers the entire fitted profile, including the offset, which represents the total flux of the star. Furthermore, EXOTIC measures field rotation to account for atmospheric and instrumental effects and uses offset to mitigate background noise, thereby improving data accuracy.


## Aperture Photometry
EXOTIC performs aperture photometry, whereby the flux of a target is extracted by measuring the sum of the light within a specified aperture around the star, ideally suited for isolated or well-defined sources with distinct light profiles. The circular aperture used by EXOTIC allows for measuring the star's brightness by encompassing as much of the object as possible, aiming to minimize contamination from neighboring sources. To achieve this, EXOTIC uses the {photutils.aperture.CircularAperture} class  to determine the light contribution of each pixel, including fractional pixels when the aperture partially covers them. The pipeline then assesses the background sky's brightness and noise levels using annular regions surrounding the apertures. By removing these values from the emitted light, EXOTIC can accurately estimate the target's brightness.
 
To optimize our measurements, EXOTIC experiments with various aperture and annulus sizes, each scaled by the standard deviation of the PSF's Full Width Half Maximum (FWHM). By testing multiple aperture and annulus sizes, EXOTIC selects the most appropriate size for accurately measuring the flux of the object while minimizing contamination from background sources and noise. Figure FOV illustrates the placement of apertures and annuli around both the target and comparison stars, facilitating the generation of field-of-view (FOV) plots that can be uploaded to the AAVSO Exoplanet Database, even in cases where aperture extraction is not selected. 

## Comparison Star Selection
EXOTIC utilizes two primary methods to source comparison stars for photometric analysis. First, the pipeline retrieves these stars by accessing the AAVSO Variable Star Plotter (VSP) if the user requests it. This API delivers a robust sequence of visual-magnitude comparison stars, ensuring their brightness measurements are well-calibrated and stable. If the passband of the input data is available within the system, it provides the comparison stars accordingly, allowing for accurate planetary parameter assessment. Furthermore, EXOTIC enables users to input comparison stars into the pipeline. By combining automated retrieval with the option for user entry, EXOTIC improves the accuracy and utility of its photometric assessments. The pipeline then selects the most suitable comparison star by minimizing the scatter of the residuals, ensuring the most accurate photometric measurements possible. EXOTIC calculates the normalized flux values for both the target and comparison stars.


## Photometric Method Selection
Determining the optimal photometric extraction method and the possible best comparison star involves performing a least-squares fit using the Levenberg-Marquardt (LM) algorithm on the model lightcurve for each technique. The LM algorithm determines the best extraction method and comparison star. Alternatively, it may opt not to use a comparison star if it introduces variability, by minimizing the scatter of the residuals. EXOTIC uses the process that results in the lowest scatter to estimate flux values for both the target and comparison stars. The normalized flux values, which provide the most distinct representation of the transit signal, are displayed in Figure Target Flux alongside the flux values for the target and comparison stars.


## Measuring Stellar Variability
EXOTIC facilitates the monitoring of stellar brightness variations by estimating the magnitude of stars, which can reveal the presence of variable stars or provide insights into atmospheric characteristics. By observing variable stars, we can predict stellar parameters such as mass, radius, temperature, and both internal and external structure, some of which are difficult to measure in non-variable stars. We can also study the impact of stellar variability on transit measurements related to exoplanet atmospheres.

To ensure accurate brightness measurement and analysis, EXOTIC retrieves the magnitudes of comparison stars with the AAVSO's Variable Star Plotter (VSP) for absolute flux calibrations and utilizes the output from the target star's photometric routine. If the photometric process identifies a VSP star as the ideal comparison star, EXOTIC calculates the target star's magnitude using its flux values. Otherwise, the pipeline computes the residuals between the normalized flux of the best-fit model lightcurve and those derived from the models of each VSP star. The VSP star that yields the minimum standard deviation of the residuals determines the target star's magnitude. EXOTIC calculates the target star's magnitude. 

A text file is generated and can be submitted to the AAVSO International Database https://www.aavso.org/aavso-international-database (AID), containing a time series of magnitude values and their respective uncertainties.


## Model Lightcurve Fit
EXOTIC utilizes a Bayesian fitting routine that simultaneously accounts for a transit model and the correction for atmospheric effects, known as airmass correction. This joint-simultaneous approach accurately estimates the planetary parameters, including the mid-transit time $T_{mid}$, orbital period $P$, and orbital inclination $i$.

As ground-based observatories are affected by airmass, every observation must undergo treatment for extinction caused by Earth's atmosphere. EXOTIC employs a parameterization that scales exponentially with airmass and uses the following equation to optimize a joint-simultaneous fit of both the transit and airmass correction function

F_{obs} = a_0e^{a_1\beta}F_{transit}

where $F_{obs}$ is the flux measured from the detector, $F_{transit}$ is the model transit lightcurve given by {PyLightcurve}, $a_0$ is the baseline flux, $a_i$ is the airmass correction coefficient, $\beta$ is the airmass value, and $e$ is the base of the natural log. 

To model the transit lightcurve with {PyLightcurve}, considering the brightness variation from a star's edge (limb) to its center, EXOTIC generates nonlinear four-parameter limb darkening coefficients. The pipeline uses {ldtk} to calculate these coefficients from the star's temperature $T$, metallicity, surface gravity log $g$, and the observational filter based on PHOENIX stellar atmosphere models.

## Nested Sampler
{Ultranest} and {dynesty} are used for Bayesian inference and statistical analysis, each characterized by distinct implementation approaches and features. Nested sampling outperforms Markov Chain Monte Carlo (MCMC) in handling multi-modal and degenerate posteriors by not relying on a thermal transition property and avoiding the burn-in phase, making it a more efficient and robust data analysis method for astrophysical applications. Both nested sampling algorithms employ multiple ellipsoid bounds to outline the parameter space within which the free parameters can traverse. In {dynesty}, we opt to use the {DynamicNestedSampler} method due to its ability to adjust live points to distribute samples more efficiently, thereby speeding up computation. The choice of the nested sampler package depends on the availability of a C compiler and libraries. For users with Mac, Unix, Linux, or Windows systems with a C compiler installed, EXOTIC uses {ultranest}. For Windows systems lacking a C compiler, EXOTIC utilizes {dynesty}. 

The nested sampling algorithm uses $T_{mid}$, $R_{p}/R_{s}$, and $i$ as free parameters with a uniform distribution in a bounded interval. Meanwhile, the sampler treats the remaining parameters ($a/R_s$, $e$, $w$, along with four-parameter limb darkening coefficients) as fixed. These free parameters are chosen based on their ability to constrain the ephemeris and estimate system parameters. Although we model the lightcurve using a least-squares fit with the Levenberg-Marquardt (LM) algorithm, we derive the final values and uncertainties using the nested sampler. If the Bayesian evidence stabilizes within a threshold (0.05) after each iteration, the algorithm has converged, indicating no further information can be gained from sampling. For well-constrained problems (i.e., each parameter having a single mode), convergence typically occurs within ~10,000-20,000 iterations. This efficiency makes nested sampling faster than Markov Chain Monte Carlo (MCMC), which usually requires around ~100,000 samples and lacks early stopping criteria. The corner plot shown in the triangle plot showcases histograms illustrating the marginalized posterior distributions for each parameter, accompanied by their estimated values and uncertainties. The sampler implements parameter constraints to ensure robust parameter exploration within established physical boundaries (e.g., the orbital inclination can not exceed $90^\circ$ as demonstrated in triangle plot. Scatter plots within the corner plot visually depict correlations among the free parameters, offering insights into their joint posterior distributions. Additionally, the corner plot facilitates the identification of parameter degeneracies, highlighting scenarios where alterations in one parameter impact another (see subplots in triangle plot that demonstrate degeneracies with their elliptical-shaped distributions). Following these visual outputs, EXOTIC documents the results using an AAVSO Exoplanet Report Form, which conforms to the specified format for AAVSO's Exoplanet Database. This form encompasses observation details, priors outlined, results detailed in posteriors table, and observation measurements comprising date, relative flux with uncertainty, and detrended airmass and airmass model information. Users can submit the report form to AAVSO's Exoplanet Database.


## TESS Lightcurve Model
EXOTIC also hosts a TESS analysis pipeline tailored for processing TESS lightcurves. This differs from the ground-based pipeline by utilizing {Lightkurve} for data aggregation. Additionally, {Wotan} is employed to detrend the data for systematic errors unrelated to the transit signal. The detrending timescale EXOTIC applies exceeds the transit duration, preserving the characteristic features of the transit signal without alteration throughout the detrending process. 

 
## Linear Ephemeris Model
Exoplanets experience gravitational forces from their host star and other planets in multiplanet systems. Consequently, these forces result in fluctuations in a planet's time-influenced parameters, such as its orbital period and transit duration. the mid-transit time uncertainty increases over time, necessitating updated transit ephemerides. To address this issue, EXOTIC includes an auxiliary package that enables users to aggregate all available mid-transit times and compute the next mid-transit time

$T_{mid} = n \cdot P + T_0$

where $T_{mid}$ is the upcoming mid-transit time, $T_0$ is the planet's mid-transit time, $P$ is planet's orbital period, and $n$ is the number of orbits between $T_0$ and $T_{mid}$. EXOTIC uses the Bayesian nested sampling package {Ultranest} to estimate the period and epoch as shown in the Observed-Calculated (O-C) plot. It compares the Bayesian evidence between linear and nonlinear ephemerides, considering perturbations from nearby companions.

Although the linear ephemeris equation does not consider non-linear variations from other effects (such as additional planets, tidal decay, orbital evolution, etc.), EXOTIC uses it because it is quick and efficient, serving as a suitable baseline. If significant residual variations are observed, such as periodic variations indicative of additional planets or systematic variations suggestive of orbital decay, these can be addressed utilizing the multiple tools available from EXOTIC.

Furthermore, we also integrate an orbital decay model alongside the linear ephemeris model into the package. The model accounts for planets experiencing tidal forces from their host star, which can induce decay in the planet's orbit. To accommodate for orbital decay, EXOTIC uses the following equation from :

$T_{mid} = T_0 + n \cdot P  + \frac{1}{2} \cdot \frac{dP}{dn} \cdot n^2$

where $\frac{dP}{dn}$ is the rate at which the orbital period changes with respect to the change in the number of orbits. 


## Lomb-Scargle Periodogram
The gravitational influence of a companion within the system perturbs a planet's orbit. One method of detecting the perturbing planet is to examine deviations in the periodic transit timings of the known transiting planet through transiting timing variations. TTVs provide valuable insights into the dynamics and architecture of multi-planet systems as they imply the presence of additional planets through mean motion resonance (MMR), characterize their orbits, and constrain planetary masses and radii. We search for TTVs within the dataset by utilizing a Lomb-Scargle periodogram to detect periodic patterns in the irregularly spaced O-C data. This procedure generates a power spectrum of the O-C data against frequency, subsequently transformed into periods. EXOTIC then uses the results of the Lomb-Scargle periodogram to fit two Fourier functions to the data through weighted least squares regression. The first-order Fourier function is applied using

$T_{mid} = n \cdot P + T_0 + A\sin(w_1n) + B\cos(w_1n)$

where $w_1 = 2\pi/P_{max}$ and $P_{max}$ represents the period of greatest power from the Lomb-Scargle periodogram. The objective of the first-order Fourier function is to identify and describe short-term fluctuations within the TTV signal. These fluctuations predominantly arise from gravitational forces acting between planets in or close to MMR. The second-order Fourier function is utilized with

$T_{\text{mid}} = n \cdot P + T_0 + A\sin(w_1n) + B\cos(w_1n) + C\sin(w_2n) + D\cos(w_2n)$

where $w_2 = 4\pi/P_{max,res}$ and $P_{max,res}$ represents the period with the highest power according to the Lomb-Scargle periodogram of the linear residuals. We use the second-order Fourier function to model and understand long-term variations in the TTV data, often linked to the orbits' precession. This precession could refer to the gradual shift in the orientation of the orbital ellipse of a planet, which gravitational interactions with other bodies in the system, relativistic effects, or other forces can cause. 

To determine which model best represents the data between the linear and Fourier fits, the pipeline applies the Bayesian Information Criterion (BIC) to obtain a numerical value for comparison. When deciding between models, the model with the lowest BIC value is generally preferred and is calculated from

$\text{BIC} = k \ln(n) - 2 \ln(\hat{L})$

where $\hat{L}$ is the maximized value of the model's likelihood function, $n$ is the number of data points, and $k$ is the number of parameters the model estimates.

Periodogram figure presents the findings for WASP-1~b as highlighted in this work. Since the signal at 131.5 days in periodogram is not significant, as determined by the false alarm probability (FAP) metric, we cannot speculate about its origins until the signal is better than the noise. Obtaining at least 20 transit observations helps confirm any potential perturbations. Further studies employing EXOTIC's Lomb-Scargle Periodogram are documented in and Huckabee et al. (2024, in preparation).


## Global Lightcurve Model
Using the global lightcurve package, EXOTIC combines and fits all transit observation data simultaneously from this study that includes Exoplanet Watch (EpW), MicroObservatory (MObs), Las Cumbres Observatory (LCO), University of Arizona's Steward Observatory, and TESS to refine the orbital parameters of WASP-1~b using the nested sampling package {Ultranest}. Large prior distributions can significantly prolong the convergence time of the global fit or prevent it altogether when dealing with large datasets. To assist the convergence of the global fit, EXOTIC fits and detrends each observation, performing an airmass fit with adjusted priors of $\pm5\sigma$. The package then conducts a global fit with these detrended data and adjusted priors, leaving the mid-transit time $T_{mid}$, orbital period $P$, orbital inclination $i$, and planet-star radius ratio $R_{p}/R_{s}$ as free parameters.


## Joint Simultaneous Fit
The simultaneous fitting module within the EXOTIC repository enables integrating transit and radial velocity (RV) data, leveraging both observation types' strengths to refine orbital parameters accurately. RV measurements assist in determining the eccentricity, orientation, and period of a planet's orbit and provide insights into the system's dynamics, including interactions with other celestial bodies that, while not directly visible, influence the observed data. Initially, EXOTIC carries out an RV analysis as outlined in, employing a Keplerian model to fit the data and determine the orbital parameters of WASP-1~b. The pipeline then fits the MObs, Kuiper, LCO, EpW, and TESS transit measurements along with the RV measurements through a joint fit using likelihood functions $\mathcal{L}$.